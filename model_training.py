# -*- coding: utf-8 -*-
"""model_training.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bZcPhc-rqCKAy4mVhqb0zJrchzjZ_Hou
"""

# src/model_training.py

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier
from xgboost import XGBClassifier
import joblib

def split_data(df):
    X = df.drop('Churn', axis=1)
    y = df['Churn'].apply(lambda x: 1 if x == 'Yes' else 0) if df['Churn'].dtype == 'object' else df['Churn']
    return train_test_split(X, y, test_size=0.3, random_state=42, stratify=y)

def train_models(X_train, y_train):
    models = {}

    lr = LogisticRegression(max_iter=1000)
    lr.fit(X_train, y_train)
    models['Logistic Regression'] = lr

    rf = RandomForestClassifier(random_state=42)
    rf.fit(X_train, y_train)
    models['Random Forest'] = rf

    xgb = XGBClassifier(use_label_encoder=False, eval_metric='logloss', random_state=42)
    xgb.fit(X_train, y_train)
    models['XGBoost'] = xgb

    return models

def save_model(model, filepath):
    joblib.dump(model, filepath)